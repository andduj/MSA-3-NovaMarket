http {
    # Разные зоны для веб и мобильных клиентов
    limit_req_zone $binary_remote_addr zone=web:10m rate=50r/s;
    limit_req_zone $binary_remote_addr zone=mobile:10m rate=30r/s;

    # Определяем тип клиента по User-Agent
    map $http_user_agent $client_zone {
        default "web";
        ~*mobile "mobile";
        ~*android "mobile";
        ~*iphone "mobile";
    }

    server {
        listen 80;

        # Веб и мобилки обращаются на этот ресурс
        location /api/ {
            # Применяем соответствующую зону лимитов
            limit_req zone=$client_zone burst=200;
            proxy_pass http://backend;
        }
    }
}